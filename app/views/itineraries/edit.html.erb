<div class="itinerary editor">
  <%= hidden_field_tag(:event_id, event.to_param) %>
  <section class="days">
    <% event.time_slots.chunk(&:date).each do |date, slots| %>
      <%= content_tag :section, class: "day", "data-date" => date.to_s(:db) do -%>
        <header><%= content_tag :h3, l(date, format: :itinerary) %></header>
        <% slots.each do |slot| %>
          <%= time_slot_header(slot) %>
          <div class="scheduled-activities">
            <%= render(partial: "itineraries/scheduled_activity", collection: slot.scheduled_activities) %>
            <% 5.times do -%>
              <article class="filler"></article>
            <% end -%>
          </div>
        <% end -%>
      <% end -%>
    <% end -%>
  </section>
  <aside class="package-limits">
    <ul>
      <% registration.package.allocations.reject(&:unlimited?).each do |allocation| -%>
        <%= content_tag :li, "data-activity-type-id" => allocation.activity_type_id do %>
          <div class="progress">
            <%= content_tag :div, "", class: "bar", style: "width: #{100 * registration.count_type(allocation.activity_type) / allocation.maximum}%" %>
          </div>
          <span class="limit">
            <%= content_tag :span, 0, class: "count" %>/<%= allocation.activity_type.pluralize(allocation.maximum) %>
          </span>
        <% end -%>
      <% end -%>
    </ul>
  </aside>
</div>
